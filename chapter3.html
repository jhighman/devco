<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 3: Burning Houses (in the Distance) - Pop Song Summer</title>
    <meta name="description" content="Chapter 3 of Pop Song Summer: Burning Houses (in the Distance) - A journey through fire and escape.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Source+Sans+Pro:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="./css/output.css">
    
    <!-- GSAP for animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <style>
        /* Base styles */
        body {
            background-color: #1A1A1A;
            color: #F5F5F5;
            font-family: 'Source Sans Pro', sans-serif;
            line-height: 1.7;
            overflow-x: hidden;
        }
        
        /* Ash texture background */
        .ash-bg {
            background-color: #1A1A1A;
            background-image: url("data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='ashPattern' patternUnits='userSpaceOnUse' width='40' height='40' patternTransform='scale(2) rotate(0)'%3E%3Crect width='40' height='40' fill='%231A1A1A'/%3E%3Cpath d='M0 0 L40 40 M40 0 L0 40' stroke='%23333333' stroke-width='0.5' stroke-opacity='0.1'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23ashPattern)'/%3E%3C/svg%3E");
        }
        
        /* Story header */
        .story-header {
            padding: 8rem 2rem 4rem;
            text-align: center;
            background: linear-gradient(to bottom, rgba(74, 0, 0, 0.9), rgba(26, 26, 26, 0.7));
            position: relative;
            overflow: hidden;
        }
        
        .story-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 4rem;
            color: #FFC107;
            margin-bottom: 1rem;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
        }
        
        .story-subtitle {
            font-size: 1.5rem;
            color: #FF5722;
            margin-bottom: 2rem;
        }
        
        .story-quote {
            font-style: italic;
            font-size: 1.25rem;
            max-width: 800px;
            margin: 0 auto 2rem;
            color: #FF5722;
            border-left: 4px solid #FFC107;
            padding-left: 1rem;
        }
        
        /* Story panels */
        .story-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .story-panel {
            margin-bottom: 6rem;
            position: relative;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            min-height: 400px;
        }
        
        .panel-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .panel-content {
            position: relative;
            z-index: 2;
            padding: 3rem;
            background-color: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(10px);
            border-left: 4px solid #FFC107;
        }
        
        .panel-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: #FFC107;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
            position: relative;
        }
        
        .panel-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, #FFC107, #FF5722);
            border-radius: 2px;
        }
        
        .panel-text {
            font-size: 1.125rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }
        
        /* Visual elements */
        .insignia {
            color: #FFC107;
            font-size: 1.5em;
            margin: 0 0.2em;
            display: inline-block;
        }
        
        .large-insignia {
            position: absolute;
            top: 50%;
            right: 5%;
            transform: translateY(-50%);
            width: 200px;
            height: 200px;
            opacity: 0.3;
            pointer-events: none;
            z-index: 1;
        }
        
        .large-insignia .circle {
            width: 100%;
            height: 100%;
            border: 8px solid #FFC107;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .large-insignia .sun {
            font-size: 6rem;
            color: #FFC107;
        }
        
        .burning-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(255, 87, 34, 0.2), rgba(255, 193, 7, 0.2));
            mix-blend-mode: overlay;
            pointer-events: none;
            z-index: 1;
        }
        
        .fire-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .fire-particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #FF5722;
            border-radius: 50%;
            opacity: 0.7;
            filter: blur(2px);
        }
        
        .ash-particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background-color: #CCCCCC;
            border-radius: 50%;
            opacity: 0.5;
            filter: blur(1px);
        }
        
        /* Neon glow effect */
        .neon-gold {
            color: #FFC107;
            text-shadow: 0 0 5px rgba(255, 193, 7, 0.8), 0 0 10px rgba(255, 193, 7, 0.5);
        }
        
        .neon-red {
            color: #FF5722;
            text-shadow: 0 0 5px rgba(255, 87, 34, 0.8), 0 0 10px rgba(255, 87, 34, 0.5);
        }
        
        /* Audio controls */
        .audio-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: rgba(26, 26, 26, 0.8);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .audio-controls button {
            background: none;
            border: none;
            color: #FFC107;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .audio-controls button:hover {
            background-color: rgba(255, 193, 7, 0.2);
        }
        
        /* Audio progress indicator */
        .audio-progress {
            position: fixed;
            bottom: 20px;
            right: 80px;
            z-index: 100;
            background-color: rgba(26, 26, 26, 0.8);
            color: #FFC107;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            backdrop-filter: blur(10px);
        }
        
        /* Scroll to top button */
        .scroll-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            background-color: rgba(26, 26, 26, 0.8);
            color: #FFC107;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            border: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .scroll-top:hover {
            background-color: rgba(255, 193, 7, 0.2);
            transform: translateY(-3px);
        }
        
        /* Animations */
        @keyframes flicker {
            0% { opacity: 0.5; }
            25% { opacity: 0.7; }
            50% { opacity: 0.3; }
            75% { opacity: 0.8; }
            100% { opacity: 0.5; }
        }
        
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0); }
        }
        
        @keyframes fallAsh {
            0% { transform: translateY(-10px) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .story-title {
                font-size: 3rem;
            }
            
            .panel-title {
                font-size: 2rem;
            }
            
            .panel-content {
                padding: 2rem;
            }
            
            .large-insignia {
                transform: scale(0.7) translateY(-50%);
            }
        }
        
        @media (max-width: 480px) {
            .story-title {
                font-size: 2.5rem;
            }
            
            .panel-title {
                font-size: 1.75rem;
            }
            
            .panel-content {
                padding: 1.5rem;
            }
            
            .large-insignia {
                transform: scale(0.5) translateY(-50%);
            }
        }
    </style>
</head>
<body class="ash-bg">
    <!-- Header/Navigation -->
    <header class="fixed top-0 left-0 w-full bg-navy bg-opacity-90 z-50 backdrop-blur-sm">
        <nav class="container-custom py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-heading font-bold text-golden-blaze">DevCo</a>
            <div class="nav-toggle md:hidden cursor-pointer">
                <div class="bar w-6 h-0.5 bg-white-spark mb-1.5"></div>
                <div class="bar w-6 h-0.5 bg-white-spark mb-1.5"></div>
                <div class="bar w-6 h-0.5 bg-white-spark"></div>
            </div>
            <ul class="hidden md:flex space-x-8">
                <li><a href="index.html" class="nav-link text-lg">Home</a></li>
                <li><a href="index.html#music" class="nav-link text-lg">Music</a></li>
                <li><a href="index.html#about" class="nav-link text-lg">About</a></li>
                <li><a href="index.html#contact" class="nav-link text-lg">Contact</a></li>
            </ul>
        </nav>
        <!-- Mobile Menu -->
        <div class="mobile-menu fixed inset-0 bg-navy bg-opacity-95 z-40 flex-col items-center justify-center hidden">
            <button class="close-btn absolute top-4 right-4 text-white-spark text-3xl">&times;</button>
            <ul class="text-center space-y-8">
                <li><a href="index.html" class="nav-link text-3xl">Home</a></li>
                <li><a href="index.html#music" class="nav-link text-3xl">Music</a></li>
                <li><a href="index.html#about" class="nav-link text-3xl">About</a></li>
                <li><a href="index.html#contact" class="nav-link text-3xl">Contact</a></li>
            </ul>
        </div>
    </header>

    <!-- Audio Element (Hidden) -->
    <audio id="background-music" loop>
        <source src="music/Chapter 3_Burning Houses (in the Distance).mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    
    <!-- Audio Controls -->
    <div class="audio-controls">
        <button id="play-pause-btn" title="Play/Pause">▶</button>
        <button id="restart-btn" title="Restart">↻</button>
    </div>
    
    <!-- Audio Progress -->
    <div class="audio-progress" id="audio-progress">0:00 / 9:00</div>
    
    <!-- Scroll to Top Button -->
    <button class="scroll-top" id="scroll-top-btn" title="Scroll to Top">↑</button>
    
    <!-- Story Header -->
    <div class="story-header">
        <h1 class="story-title">Burning Houses (in the Distance)</h1>
        <p class="story-subtitle">Pop Song Summer, Track 3</p>
        <blockquote class="story-quote">
            "She comes, burning houses in the distance."
        </blockquote>
        <button id="start-reading-btn" class="bg-golden-blaze text-navy px-6 py-3 rounded-md hover:bg-opacity-80 transition-colors font-bold text-lg">
            Start Reading with Music
        </button>
    </div>
    
    <!-- Story Content -->
    <div class="story-container" id="story-content">
        <!-- Story panels will be dynamically generated here -->
    </div>
    
    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const audio = document.getElementById('background-music');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const restartBtn = document.getElementById('restart-btn');
            const startReadingBtn = document.getElementById('start-reading-btn');
            const scrollTopBtn = document.getElementById('scroll-top-btn');
            const storyContainer = document.getElementById('story-content');
            const audioProgress = document.getElementById('audio-progress');
            
            // Story data (embedded directly in the page for simplicity)
            const storyData = [
                {
                    title: "MOTEL ESCAPE",
                    background: "bg-gradient-to-b from-[#4A0000] via-[#1A1A1A] to-[#4A0000]",
                    text: "The night we decided to run, the horizon burned with real flames chewing the suburbs. The motel parking lot smelled of pine resin, drywall, gasoline, and denial. Cars idled like nervous animals, the ice machine died, and a CASH ONLY sign hung on the vending machine. She sat on the curb, red coat fraying, flicking ash toward the glow. 'We could stay,' I said. 'That's what everybody says before they burn,' she replied, tugging my sleeve. We packed toothbrushes, socks, water, pretzels, and a metal box with cash, a half-used gift card, and two gold-thread sunburst patches. She pinned one to her coat, handed me the other. 'It's not a club,' she said. 'It's a receipt for light.'",
                    hasInsignia: true,
                    hasBurning: true
                },
                {
                    title: "ROAD AND RADIO",
                    background: "bg-gradient-to-b from-[#1A2A44] via-[#000000] to-[#1A2A44]",
                    text: "The freeway was a parking lot, so we took side streets where houses held their breath and sprinklers made useless halos. In the rearview, smoke rose like a theater curtain. At a four-way stop, a woman in a bathrobe glared, teens pushed a cart of water and dog food, and the radio crackled to life with a woman's voice singing about horizons and burning houses, disco bones under velvet neon. Gas cost a miracle, the terminal OFFLINE. She stood under the floodlight, patch glowing, and told a man the wind had already shifted. Ash fell like soft lies, smearing gray streaks on the windshield. 'I left the photo,' she said, of her mother on a beach. 'Memory is a copy of a copy. Fire is an eraser.'",
                    hasInsignia: true,
                    hasBurning: true
                },
                {
                    title: "SPACESHIP DINER",
                    background: "bg-gradient-to-b from-[#4A4A4A] via-[#2D2D2D] to-[#4A4A4A]",
                    text: "We stopped at a diner shaped like a spaceship, its open sign glowing with plastic optimism. Waitresses moved like marathoners, serving coffee and calm. We ordered pancakes—round things for the end of the world. Flo, the waitress, eyed our patches but didn't blink. 'You two headed where?' 'Out,' I said. In the corner, a blind man sang against the radio: She comes, burning houses in the distance. Lights up the night. A kid drew a chalk sunburst with twelve rays under a table. 'Ready to return?' he asked me, grave as a judge. The blind man warned, 'Leave before the wind changes.' Outside, the sky turned a color without a name, and she kissed me hard. 'For luck,' she said.",
                    hasInsignia: true,
                    hasBurning: true,
                    neonTitle: true,
                    neonColor: "red"
                },
                {
                    title: "HIGHWAY FLIGHT",
                    background: "bg-gradient-to-b from-[#800020] via-[#FFC107] to-[#800020]",
                    text: "Highway south, traffic darted like fish or stampeded. We passed an overturned camper, its owner in a smoking jacket waving an apology. Sirens wove a new music, emergency crawlers contradicting each other: Do Not Use This Route. Use Only This Route. On a hill, we saw a neighborhood burn, houses like they'd stored up fire. 'Fire is the truest currency,' she said. 'You give it anything, it gives you heat and light. Until it takes it all.' A culvert bore a spray-painted sunburst: WE RETURN WHAT WE TAKE. My phone rang, a voice saying, 'You're early or late. You already joined.' She smirked. 'Heliograph?' 'Everything's a door if it keeps you from burning.'",
                    hasInsignia: true,
                    hasBurning: true,
                    neonTitle: true,
                    neonColor: "gold"
                },
                {
                    title: "CHECKPOINT AND CROSSING",
                    background: "bg-gradient-to-b from-[#2D2D2D] via-[#1A1A1A] to-[#2D2D2D]",
                    text: "At the county line, a checkpoint of cones and uniformed men stopped us. A deputy saw her patch. 'Friends of the sun?' 'Borrowers,' she said. 'Remain on County 12. No promises past the bridge.' We crossed, the river below moving like a spine, a canoe with two silhouettes and a dog gliding beneath. On the other side, trees lay like pickup sticks, a billboard advertised a boiled waterpark, and the radio replayed the horizon song. We passed a roller rink turned shelter, kids skating between cots, a mascot's grin pleading. The sign read TONIGHT: ADULTS ONLY, with WITH CHILDREN added in duct tape.",
                    hasInsignia: true,
                    hasBurning: true
                },
                {
                    title: "DESERT BAR",
                    background: "bg-gradient-to-b from-[#2D0A31] via-[#1A0E25] to-[#2D0A31]",
                    text: "Past midnight, we hit a forgotten town with a gas station, a bar, and a church that skipped weekdays. The bar's neon OPEN lied. Inside, four men stared at a TV painting the world orange. She ordered water and something brown. A man noticed her patch. 'My sister said pin it and pray in a storage unit.' 'It's a receipt,' she said, 'for what you keep.' The bartender handed me water bottles. 'Return what isn't yours.' Outside, she blessed the car's hood like a casket. 'One more push,' she said. 'Up.' The wind carried smoke south, the sun hid in ash, and a deer, charred at the edges, crossed our path, betrayed by evolution.",
                    hasInsignia: true,
                    hasBurning: true
                },
                {
                    title: "OUT TO THE OTHER SIDE",
                    background: "bg-gradient-to-b from-[#FFC107] via-[#FF3300] to-[#FFC107]",
                    text: "We climbed switchbacks to a crest where the world unrolled: north, an orange bruise; south, a black morning waiting for the right ticket. 'You said I looked like trouble,' she said. 'And I said you could carry it.' We laughed, her pulse against my ribs, the air smelling of sage and dust. She'd once lit a match at eleven, burning her father's junk, the smoke making a new sky. Now, the fireline redrew itself below, a strict calligraphy. 'It stops being yours,' she said of fire. The radio sang She comes, burning houses in the distance. We drove south, patches heavy, into a morning that insisted on itself, the road writing its song in fading lines.",
                    hasInsignia: true,
                    hasBurning: true,
                    epilogue: true,
                    neonTitle: true,
                    neonColor: "red"
                }
            ];
            
            // Function to format time in MM:SS format
            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = Math.floor(seconds % 60);
                return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
            }
            
            // Function to generate story panels
            function generateStoryPanels() {
                storyContainer.innerHTML = '';
                
                storyData.forEach((panel, index) => {
                    // Create panel element
                    const panelElement = document.createElement('div');
                    panelElement.className = 'story-panel';
                    panelElement.id = `panel-${index + 1}`;
                    
                    // Create panel background
                    const panelBackground = document.createElement('div');
                    panelBackground.className = `panel-background ${panel.background}`;
                    
                    // Add visual elements based on panel properties
                    if (panel.hasInsignia) {
                        const insignia = document.createElement('div');
                        insignia.className = 'large-insignia';
                        insignia.innerHTML = `
                            <div class="circle">
                                <div class="sun">☀</div>
                            </div>
                        `;
                        panelBackground.appendChild(insignia);
                    }
                    
                    if (panel.hasBurning) {
                        const burningOverlay = document.createElement('div');
                        burningOverlay.className = 'burning-overlay';
                        panelBackground.appendChild(burningOverlay);
                        
                        // Add fire particles
                        const fireParticles = document.createElement('div');
                        fireParticles.className = 'fire-particles';
                        
                        // Create random fire particles
                        for (let i = 0; i < 20; i++) {
                            const particle = document.createElement('div');
                            particle.className = 'fire-particle';
                            particle.style.left = `${Math.random() * 100}%`;
                            particle.style.top = `${Math.random() * 100}%`;
                            particle.style.opacity = `${0.3 + Math.random() * 0.5}`;
                            particle.style.animation = `flicker ${1 + Math.random() * 3}s infinite, float ${3 + Math.random() * 5}s infinite`;
                            fireParticles.appendChild(particle);
                        }
                        
                        // Create random ash particles
                        for (let i = 0; i < 30; i++) {
                            const ash = document.createElement('div');
                            ash.className = 'ash-particle';
                            ash.style.left = `${Math.random() * 100}%`;
                            ash.style.top = `${Math.random() * 100}%`;
                            ash.style.animation = `fallAsh ${5 + Math.random() * 10}s linear infinite`;
                            ash.style.animationDelay = `${Math.random() * 5}s`;
                            fireParticles.appendChild(ash);
                        }
                        
                        panelBackground.appendChild(fireParticles);
                    }
                    
                    // Create panel content
                    const panelContent = document.createElement('div');
                    panelContent.className = 'panel-content';
                    
                    // Create panel title
                    const panelTitle = document.createElement('h2');
                    if (panel.neonTitle) {
                        panelTitle.className = `panel-title neon-${panel.neonColor || 'gold'}`;
                    } else {
                        panelTitle.className = 'panel-title';
                    }
                    panelTitle.textContent = panel.title;
                    
                    // Create panel text
                    const panelText = document.createElement('p');
                    panelText.className = 'panel-text';
                    panelText.textContent = panel.text;
                    
                    // Add elements to panel content
                    panelContent.appendChild(panelTitle);
                    panelContent.appendChild(panelText);
                    
                    // Add elements to panel
                    panelElement.appendChild(panelBackground);
                    panelElement.appendChild(panelContent);
                    
                    // Add panel to story container
                    storyContainer.appendChild(panelElement);
                });
                
                // Initialize GSAP animations
                initAnimations();
            }
            
            // Function to initialize GSAP animations
            function initAnimations() {
                // Register ScrollTrigger plugin
                gsap.registerPlugin(ScrollTrigger);
                
                // Animate insignias
                gsap.utils.toArray('.large-insignia').forEach((insignia) => {
                    gsap.to(insignia, {
                        opacity: 0.7,
                        duration: 3,
                        repeat: -1,
                        yoyo: true,
                        ease: "sine.inOut"
                    });
                });
                
                // Animate burning overlays
                gsap.utils.toArray('.burning-overlay').forEach((overlay) => {
                    gsap.to(overlay, {
                        opacity: 0.4,
                        duration: 2,
                        repeat: -1,
                        yoyo: true,
                        ease: "sine.inOut"
                    });
                });
                
                // Animate panels on scroll
                gsap.utils.toArray('.story-panel').forEach((panel, i) => {
                    // Fade in panel
                    gsap.fromTo(panel, 
                        { opacity: 0, y: 50 },
                        { 
                            opacity: 1, 
                            y: 0,
                            duration: 1,
                            scrollTrigger: {
                                trigger: panel,
                                start: "top 80%",
                                end: "top 50%",
                                scrub: 1
                            }
                        }
                    );
                    
                    // Parallax effect on background
                    gsap.to(panel.querySelector('.panel-background'), {
                        y: -50,
                        duration: 1,
                        ease: "none",
                        scrollTrigger: {
                            trigger: panel,
                            start: "top bottom",
                            end: "bottom top",
                            scrub: true
                        }
                    });
                });
            }
            
            // Function to update audio progress
            function updateAudioProgress() {
                if (audio.duration) {
                    const currentTime = audio.currentTime;
                    const duration = audio.duration;
                    audioProgress.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
                }
            }
            
            // Audio event listeners
            audio.addEventListener('timeupdate', updateAudioProgress);
            
            // Play/Pause button functionality
            playPauseBtn.addEventListener('click', function() {
                if (audio.paused) {
                    audio.play();
                    playPauseBtn.textContent = '❚❚';
                } else {
                    audio.pause();
                    playPauseBtn.textContent = '▶';
                }
            });
            
            // Restart button functionality
            restartBtn.addEventListener('click', function() {
                audio.currentTime = 0;
                if (audio.paused) {
                    audio.play();
                    playPauseBtn.textContent = '❚❚';
                }
            });
            
            // Start reading button functionality
            startReadingBtn.addEventListener('click', function() {
                audio.play();
                playPauseBtn.textContent = '❚❚';
                window.scrollTo({
                    top: storyContainer.offsetTop - 100,
                    behavior: 'smooth'
                });
                startReadingBtn.style.display = 'none';
            });
            
            // Scroll to top button functionality
            scrollTopBtn.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // Show/hide scroll to top button based on scroll position
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    scrollTopBtn.style.opacity = '1';
                } else {
                    scrollTopBtn.style.opacity = '0';
                }
            });
            
            // Mobile menu functionality
            const navToggle = document.querySelector('.nav-toggle');
            const mobileMenu = document.querySelector('.mobile-menu');
            const closeBtn = document.querySelector('.close-btn');
            
            if (navToggle && mobileMenu && closeBtn) {
                navToggle.addEventListener('click', function() {
                    mobileMenu.classList.add('flex');
                    mobileMenu.classList.remove('hidden');
                });
                
                closeBtn.addEventListener('click', function() {
                    mobileMenu.classList.remove('flex');
                    mobileMenu.classList.add('hidden');
                });
                
                // Close mobile menu when clicking a link
                const mobileLinks = mobileMenu.querySelectorAll('a');
                mobileLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        mobileMenu.classList.remove('flex');
                        mobileMenu.classList.add('hidden');
                    });
                });
            }
            
            // Generate story panels on page load
            generateStoryPanels();
        });
    </script>
</body>
</html>