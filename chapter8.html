<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 8: 1985 (Disco Time Machine) - Pop Song Summer</title>
    <meta name="description" content="Chapter 8 of Pop Song Summer: 1985 (Disco Time Machine) - A journey through time with disco beats.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=VT323&family=Source+Sans+Pro:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="./css/output.css">
    
    <!-- GSAP for animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <style>
        /* Base styles */
        body {
            background-color: #0A0A0A;
            color: #F5F5F5;
            font-family: 'Source Sans Pro', sans-serif;
            line-height: 1.7;
            overflow-x: hidden;
        }
        
        /* Retro grid background */
        .retro-bg {
            background-color: #0A0A0A;
            background-image: url("data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='gridPattern' patternUnits='userSpaceOnUse' width='40' height='40' patternTransform='scale(2) rotate(0)'%3E%3Crect width='40' height='40' fill='%230A0A0A'/%3E%3Cpath d='M0 0 L40 0 M0 10 L40 10 M0 20 L40 20 M0 30 L40 30 M0 40 L40 40 M0 0 L0 40 M10 0 L10 40 M20 0 L20 40 M30 0 L30 40 M40 0 L40 40' stroke='%23FF00FF' stroke-width='0.5' stroke-opacity='0.1'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23gridPattern)'/%3E%3C/svg%3E");
            position: relative;
        }
        
        .retro-bg::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(10, 10, 10, 0.8), rgba(10, 10, 10, 0.3), rgba(10, 10, 10, 0.8));
            pointer-events: none;
            z-index: -1;
        }
        
        /* Story header */
        .story-header {
            padding: 8rem 2rem 4rem;
            text-align: center;
            background: linear-gradient(to bottom, rgba(26, 42, 68, 0.9), rgba(10, 10, 10, 0.7));
            position: relative;
            overflow: hidden;
        }
        
        .story-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 4rem;
            color: #FF00FF;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.8), 0 0 20px rgba(255, 0, 255, 0.5);
        }
        
        .story-subtitle {
            font-size: 1.5rem;
            color: #00FFFF;
            margin-bottom: 2rem;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.8), 0 0 20px rgba(0, 255, 255, 0.5);
        }
        
        .story-quote {
            font-style: italic;
            font-size: 1.25rem;
            max-width: 800px;
            margin: 0 auto 2rem;
            color: #FFC107;
            border-left: 4px solid #FF00FF;
            padding-left: 1rem;
        }
        
        /* Story panels */
        .story-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .story-panel {
            margin-bottom: 6rem;
            position: relative;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.3), 0 0 40px rgba(0, 255, 255, 0.2);
            min-height: 400px;
        }
        
        .panel-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .panel-content {
            position: relative;
            z-index: 2;
            padding: 3rem;
            background-color: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(10px);
            border-left: 4px solid #FF00FF;
        }
        
        .panel-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: #FF00FF;
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.8), 0 0 20px rgba(255, 0, 255, 0.5);
            position: relative;
        }
        
        .panel-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, #FF00FF, #00FFFF);
            border-radius: 2px;
        }
        
        .panel-text {
            font-size: 1.125rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }
        
        /* Visual elements */
        .insignia {
            color: #FFC107;
            font-size: 1.5em;
            margin: 0 0.2em;
            display: inline-block;
        }
        
        .large-insignia {
            position: absolute;
            top: 50%;
            right: 5%;
            transform: translateY(-50%);
            width: 200px;
            height: 200px;
            opacity: 0.3;
            pointer-events: none;
            z-index: 1;
        }
        
        .large-insignia .circle {
            width: 100%;
            height: 100%;
            border: 8px solid #FFC107;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .large-insignia .sun {
            font-size: 6rem;
            color: #FFC107;
        }
        
        .burning-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(255, 87, 34, 0.2), rgba(255, 193, 7, 0.2));
            mix-blend-mode: overlay;
            pointer-events: none;
            z-index: 1;
        }
        
        /* Retro elements */
        .retro-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255, 0, 255, 0.1), rgba(0, 255, 255, 0.1));
            mix-blend-mode: overlay;
            pointer-events: none;
            z-index: 1;
        }
        
        .retro-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(0deg, rgba(255, 0, 255, 0.1) 1px, transparent 1px), 
                              linear-gradient(90deg, rgba(255, 0, 255, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 1;
            perspective: 1000px;
            transform-style: preserve-3d;
            transform: rotateX(60deg);
        }
        
        .time-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .time-particle {
            position: absolute;
            width: 5px;
            height: 5px;
            background-color: #FF00FF;
            border-radius: 50%;
            opacity: 0.7;
            filter: blur(1px);
        }
        
        .digital-clock {
            font-family: 'VT323', monospace;
            font-size: 1.5rem;
            color: #00FFFF;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.8);
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 3;
        }
        
        /* Neon glow effect */
        .neon-gold {
            color: #FFC107;
            text-shadow: 0 0 5px rgba(255, 193, 7, 0.8), 0 0 10px rgba(255, 193, 7, 0.5);
        }
        
        .neon-red {
            color: #FF5722;
            text-shadow: 0 0 5px rgba(255, 87, 34, 0.8), 0 0 10px rgba(255, 87, 34, 0.5);
        }
        
        /* Audio controls */
        .audio-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: rgba(10, 10, 10, 0.8);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 0, 255, 0.3);
            box-shadow: 0 0 10px rgba(255, 0, 255, 0.3);
        }
        
        .audio-controls button {
            background: none;
            border: none;
            color: #FF00FF;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .audio-controls button:hover {
            background-color: rgba(255, 0, 255, 0.2);
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.8);
        }
        
        /* Audio progress indicator */
        .audio-progress {
            position: fixed;
            bottom: 20px;
            right: 80px;
            z-index: 100;
            background-color: rgba(10, 10, 10, 0.8);
            color: #00FFFF;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.3);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
            font-family: 'VT323', monospace;
        }
        
        /* Scroll to top button */
        .scroll-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            background-color: rgba(10, 10, 10, 0.8);
            color: #FF00FF;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            border: 1px solid rgba(255, 0, 255, 0.3);
            box-shadow: 0 0 10px rgba(255, 0, 255, 0.3);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .scroll-top:hover {
            background-color: rgba(255, 0, 255, 0.2);
            transform: translateY(-3px);
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.8);
        }
        
        /* Animations */
        @keyframes timeTravel {
            0% { transform: translateY(0) scale(1); opacity: 0.7; }
            50% { transform: translateY(-20px) scale(1.5); opacity: 0.3; }
            100% { transform: translateY(-40px) scale(0.5); opacity: 0; }
        }
        
        @keyframes clockFlicker {
            0% { opacity: 1; }
            49% { opacity: 1; }
            50% { opacity: 0.5; }
            51% { opacity: 1; }
            59% { opacity: 1; }
            60% { opacity: 0.5; }
            61% { opacity: 1; }
            100% { opacity: 1; }
        }
        
        @keyframes neonPulse {
            0% { text-shadow: 0 0 5px rgba(255, 0, 255, 0.8), 0 0 10px rgba(255, 0, 255, 0.5); }
            50% { text-shadow: 0 0 10px rgba(255, 0, 255, 0.8), 0 0 20px rgba(255, 0, 255, 0.5), 0 0 30px rgba(255, 0, 255, 0.3); }
            100% { text-shadow: 0 0 5px rgba(255, 0, 255, 0.8), 0 0 10px rgba(255, 0, 255, 0.5); }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .story-title {
                font-size: 3rem;
            }
            
            .panel-title {
                font-size: 2rem;
            }
            
            .panel-content {
                padding: 2rem;
            }
            
            .large-insignia {
                transform: scale(0.7) translateY(-50%);
            }
        }
        
        @media (max-width: 480px) {
            .story-title {
                font-size: 2.5rem;
            }
            
            .panel-title {
                font-size: 1.75rem;
            }
            
            .panel-content {
                padding: 1.5rem;
            }
            
            .large-insignia {
                transform: scale(0.5) translateY(-50%);
            }
        }
    </style>
</head>
<body class="retro-bg">
    <!-- Header/Navigation -->
    <header class="fixed top-0 left-0 w-full bg-navy bg-opacity-90 z-50 backdrop-blur-sm">
        <nav class="container-custom py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-heading font-bold text-golden-blaze">DevCo</a>
            <div class="nav-toggle md:hidden cursor-pointer">
                <div class="bar w-6 h-0.5 bg-white-spark mb-1.5"></div>
                <div class="bar w-6 h-0.5 bg-white-spark mb-1.5"></div>
                <div class="bar w-6 h-0.5 bg-white-spark"></div>
            </div>
            <ul class="hidden md:flex space-x-8">
                <li><a href="index.html" class="nav-link text-lg">Home</a></li>
                <li><a href="index.html#music" class="nav-link text-lg">Music</a></li>
                <li><a href="index.html#about" class="nav-link text-lg">About</a></li>
                <li><a href="index.html#contact" class="nav-link text-lg">Contact</a></li>
            </ul>
        </nav>
        <!-- Mobile Menu -->
        <div class="mobile-menu fixed inset-0 bg-navy bg-opacity-95 z-40 flex-col items-center justify-center hidden">
            <button class="close-btn absolute top-4 right-4 text-white-spark text-3xl">&times;</button>
            <ul class="text-center space-y-8">
                <li><a href="index.html" class="nav-link text-3xl">Home</a></li>
                <li><a href="index.html#music" class="nav-link text-3xl">Music</a></li>
                <li><a href="index.html#about" class="nav-link text-3xl">About</a></li>
                <li><a href="index.html#contact" class="nav-link text-3xl">Contact</a></li>
            </ul>
        </div>
    </header>

    <!-- Audio Element (Hidden) -->
    <audio id="background-music" loop>
        <source src="music/Chapter 8_1985 (Disco Time Machine).mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    
    <!-- Audio Controls -->
    <div class="audio-controls">
        <button id="play-pause-btn" title="Play/Pause">▶</button>
        <button id="restart-btn" title="Restart">↻</button>
    </div>
    
    <!-- Audio Progress -->
    <div class="audio-progress" id="audio-progress">0:00 / 8:30</div>
    
    <!-- Scroll to Top Button -->
    <button class="scroll-top" id="scroll-top-btn" title="Scroll to Top">↑</button>
    
    <!-- Story Header -->
    <div class="story-header">
        <h1 class="story-title" style="animation: neonPulse 2s infinite;">1985 (Disco Time Machine)</h1>
        <p class="story-subtitle">Pop Song Summer, Track 8</p>
        <blockquote class="story-quote">
            "She comes, into the pop song summer."
        </blockquote>
        <button id="start-reading-btn" class="bg-golden-blaze text-navy px-6 py-3 rounded-md hover:bg-opacity-80 transition-colors font-bold text-lg">
            Start Reading with Music
        </button>
        
        <!-- Digital clock in header -->
        <div class="digital-clock" id="digital-clock" style="animation: clockFlicker 4s infinite;">
            19:85:00
        </div>
    </div>
    
    <!-- Story Content -->
    <div class="story-container" id="story-content">
        <!-- Story panels will be dynamically generated here -->
    </div>
    
    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const audio = document.getElementById('background-music');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const restartBtn = document.getElementById('restart-btn');
            const startReadingBtn = document.getElementById('start-reading-btn');
            const scrollTopBtn = document.getElementById('scroll-top-btn');
            const storyContainer = document.getElementById('story-content');
            const audioProgress = document.getElementById('audio-progress');
            const digitalClock = document.getElementById('digital-clock');
            
            // Story data (embedded directly in the page for simplicity)
            const storyData = [
                {
                    title: "THRIFT STORE FIND",
                    background: "bg-gradient-to-b from-[#2D2D2D] via-[#1A1A1A] to-[#2D2D2D]",
                    text: "In a thrift store in a dead mall, a crate of $1 disco records hides a white-label 12-inch, stamped with a gold-foil sunburst, twelve rays, etched with HELIOGRAPH / 12 DOORS / +6% / -6% / FOR RETURN. The clerk, in an I'M NOT A ROBOT shirt, says it's not for sale. I set a five on the counter. He slides it to me in a sleeve smelling of winter. 'Don't play it loud,' he says. 'I don't do anything loud,' I lie. The air smells of dust and forgotten decisions, the mall's neon sign half-lit: FOA FO A WEAR.",
                    hasInsignia: true,
                    year: "1985"
                },
                {
                    title: "TIME MACHINE DECK",
                    background: "bg-gradient-to-b from-[#1A2A44] via-[#000000] to-[#1A2A44]",
                    text: "At home, my Technics 1200s are a religion. I place the white-label on the left deck, superstitious. The needle drops; silence hums like a dog expecting its name. Then: hi-hat like a subway gate, bass thick as nostalgia, strings curving air. A woman's voice sings, She comes… The pitch fader at +6% yellows the room; my phone flickers into a walkman, a landline rings in a kitchen without one. The street grows Datsuns, neon reads FOAM AND FORMALWEAR. At -6%, the snare modernizes, the room snaps back. The runoff groove whispers: Return what isn't yours. Wednesday, nine, unit four-thirteen.",
                    hasInsignia: true,
                    neonTitle: true,
                    neonColor: "gold",
                    year: "1985"
                },
                {
                    title: "ROLLER RINK REVIVAL",
                    background: "bg-gradient-to-b from-[#4A4A4A] via-[#2D2D2D] to-[#4A4A4A]",
                    text: "The dead mall's roller rink opens Fridays, promising ADULTS ONLY TONIGHT. The DJ, in a DON'T PANIC hoodie, eyes the sunburst record. 'You a member?' 'It's a toll,' I say. At eleven, I drop the needle. The hi-hat rumors, the voice reefs the ceiling: Pop song summer. At +6%, lights warm, the mirror ball infects, jackets grow shoulder pads. Skaters sing, She comes, unrehearsed. A woman in a red coat skates, her sunburst patch catching lasers. The rink becomes 1985; a ferris wheel turns in the glass. A kid redraws a chalk sunburst on the wall.",
                    hasInsignia: true,
                    hasBurning: true,
                    neonTitle: true,
                    neonColor: "red",
                    year: "1985"
                },
                {
                    title: "SKATING THROUGH TIME",
                    background: "bg-gradient-to-b from-[#800020] via-[#4A0000] to-[#800020]",
                    text: "The house DJ says, 'Lift at the bridge—now.' I push the fader to +10%; time dilates, wheels spark. The red-coat woman skates backward, laughing silently, her patch a corrected laser. Skaters mouth lyrics they didn't learn: Pop song summer. In the snack bar glass, houses burn four cities away. A man asks, 'What is this?' 'Receipt for time,' she says. The runoff groove repeats: Return what isn't yours. Resist seven. The rink breathes like a survivor. The DJ slides the record back: 'It'll want a toll.' 'What you stole,' she says. I know better.",
                    hasInsignia: true,
                    hasBurning: true,
                    year: "1985"
                },
                {
                    title: "PAYPHONE CALL",
                    background: "bg-gradient-to-b from-[#2D0A31] via-[#1A0E25] to-[#2D0A31]",
                    text: "In the mall, a dead payphone rings. I answer; a woman's voice, not the red-coat's, says, 'You're early or late. Either works.' 'I have the record,' I say. 'You have a door. Bring nothing. Return everything.' The call ends. I pack the white-label like a loved hostage. The neon flickers to FOA FO A WEAR. A kid outside draws a chalk sunburst, adding a thirteenth ray. The rink's lights dim, the city in the glass shows burning houses. The record's weight lies; it's the same, but I'm not. The toll is what I stole: time, her, a name I scuff on my license.",
                    hasInsignia: true,
                    hasBurning: true,
                    year: "1985"
                },
                {
                    title: "UNIT 413 RITUAL",
                    background: "bg-gradient-to-b from-[#1A2A44] via-[#FFC107] to-[#1A2A44]",
                    text: "Unit 413, in a storage facility, yawns open. Inside: candles circle a milk crate altar with a cassette deck, a jar of sunburst patches, a chalk diagram of twelve notches. An androgynous figure with a sunburst patch says, 'You brought it.' I set the record down; it warms under my palm. 'What did you steal?' they ask. 'Time. Her.' They nod, administrative. I place my license down, scraping my name. 'Return what isn't yours,' they say. The red-coat woman appears in the doorway, her patch glowing. 'Wednesday,' she says. 'Nine,' I reply. The cassette exhales a skating tone.",
                    hasInsignia: true,
                    neonTitle: true,
                    neonColor: "gold",
                    year: "1985"
                },
                {
                    title: "RETURN AND KEEP",
                    background: "bg-gradient-to-b from-[#FFC107] via-[#FF3300] to-[#FFC107]",
                    text: "'Ready to return?' the figure asks. I leave the record, keep the song. Stepping around the chalk circle, I exit to a night smelling like 1985. At home, the slipmat holds a sunburst ghost. The radio, unasked, plays Sunroom's frequency, my voice singing a chorus I didn't write. A kid's chalk circle outside counts to thirteen. The blind man's note hums from a bridge. The red-coat woman lifts a hand in the glass. She comes, the city sings, into the pop song summer. I press the slipmat's mark, feeling thread bite. Wednesday, nine, unit 413. I don't plan to go. I'm going.",
                    hasInsignia: true,
                    hasBurning: true,
                    epilogue: true,
                    neonTitle: true,
                    neonColor: "red",
                    year: "1985"
                }
            ];
            
            // Function to format time in MM:SS format
            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = Math.floor(seconds % 60);
                return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
            }
            
            // Function to update digital clock
            function updateDigitalClock() {
                const now = new Date();
                const hours = now.getHours();
                const minutes = now.getMinutes();
                const seconds = now.getSeconds();
                
                // Format as 19:85:XX to represent the year 1985
                digitalClock.textContent = `19:85:${seconds.toString().padStart(2, '0')}`;
            }
            
            // Start digital clock
            setInterval(updateDigitalClock, 1000);
            
            // Function to generate story panels
            function generateStoryPanels() {
                storyContainer.innerHTML = '';
                
                storyData.forEach((panel, index) => {
                    // Create panel element
                    const panelElement = document.createElement('div');
                    panelElement.className = 'story-panel';
                    panelElement.id = `panel-${index + 1}`;
                    
                    // Create panel background
                    const panelBackground = document.createElement('div');
                    panelBackground.className = `panel-background ${panel.background}`;
                    
                    // Add visual elements based on panel properties
                    if (panel.hasInsignia) {
                        const insignia = document.createElement('div');
                        insignia.className = 'large-insignia';
                        insignia.innerHTML = `
                            <div class="circle">
                                <div class="sun">☀</div>
                            </div>
                        `;
                        panelBackground.appendChild(insignia);
                    }
                    
                    if (panel.hasBurning) {
                        const burningOverlay = document.createElement('div');
                        burningOverlay.className = 'burning-overlay';
                        panelBackground.appendChild(burningOverlay);
                    }
                    
                    // Add retro elements
                    const retroOverlay = document.createElement('div');
                    retroOverlay.className = 'retro-overlay';
                    panelBackground.appendChild(retroOverlay);
                    
                    const retroGrid = document.createElement('div');
                    retroGrid.className = 'retro-grid';
                    panelBackground.appendChild(retroGrid);
                    
                    // Add time particles
                    const timeParticles = document.createElement('div');
                    timeParticles.className = 'time-particles';
                    
                    // Create random time particles
                    for (let i = 0; i < 20; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'time-particle';
                        particle.style.left = `${Math.random() * 100}%`;
                        particle.style.top = `${Math.random() * 100}%`;
                        particle.style.opacity = `${0.3 + Math.random() * 0.5}`;
                        particle.style.animation = `timeTravel ${3 + Math.random() * 5}s infinite`;
                        particle.style.animationDelay = `${Math.random() * 3}s`;
                        timeParticles.appendChild(particle);
                    }
                    
                    panelBackground.appendChild(timeParticles);
                    
                    // Add digital clock to panel
                    if (panel.year) {
                        const clock = document.createElement('div');
                        clock.className = 'digital-clock';
                        clock.textContent = panel.year;
                        clock.style.animation = 'clockFlicker 4s infinite';
                        panelBackground.appendChild(clock);
                    }
                    
                    // Create panel content
                    const panelContent = document.createElement('div');
                    panelContent.className = 'panel-content';
                    
                    // Create panel title
                    const panelTitle = document.createElement('h2');
                    if (panel.neonTitle) {
                        panelTitle.className = `panel-title neon-${panel.neonColor || 'gold'}`;
                        panelTitle.style.animation = 'neonPulse 2s infinite';
                    } else {
                        panelTitle.className = 'panel-title';
                    }
                    panelTitle.textContent = panel.title;
                    
                    // Create panel text
                    const panelText = document.createElement('p');
                    panelText.className = 'panel-text';
                    panelText.textContent = panel.text;
                    
                    // Add elements to panel content
                    panelContent.appendChild(panelTitle);
                    panelContent.appendChild(panelText);
                    
                    // Add elements to panel
                    panelElement.appendChild(panelBackground);
                    panelElement.appendChild(panelContent);
                    
                    // Add panel to story container
                    storyContainer.appendChild(panelElement);
                });
                
                // Initialize GSAP animations
                initAnimations();
            }
            
            // Function to initialize GSAP animations
            function initAnimations() {
                // Register ScrollTrigger plugin
                gsap.registerPlugin(ScrollTrigger);
                
                // Animate insignias
                gsap.utils.toArray('.large-insignia').forEach((insignia) => {
                    gsap.to(insignia, {
                        opacity: 0.7,
                        duration: 3,
                        repeat: -1,
                        yoyo: true,
                        ease: "sine.inOut"
                    });
                });
                
                // Animate retro grid
                gsap.utils.toArray('.retro-grid').forEach((grid) => {
                    gsap.to(grid, {
                        backgroundPosition: '0 100px',
                        duration: 10,
                        repeat: -1,
                        ease: "none"
                    });
                });
                
                // Animate panels on scroll
                gsap.utils.toArray('.story-panel').forEach((panel, i) => {
                    // Fade in panel
                    gsap.fromTo(panel,
                        { opacity: 0, y: 50 },
                        {
                            opacity: 1,
                            y: 0,
                            duration: 1,
                            scrollTrigger: {
                                trigger: panel,
                                start: "top 80%",
                                end: "top 50%",
                                scrub: 1
                            }
                        }
                    );
                    
                    // Parallax effect on background
                    gsap.to(panel.querySelector('.panel-background'), {
                        y: -50,
                        duration: 1,
                        ease: "none",
                        scrollTrigger: {
                            trigger: panel,
                            start: "top bottom",
                            end: "bottom top",
                            scrub: true
                        }
                    });
                });
            }
            
            // Function to update audio progress
            function updateAudioProgress() {
                if (audio.duration) {
                    const currentTime = audio.currentTime;
                    const duration = audio.duration;
                    audioProgress.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
                }
            }
            
            // Audio event listeners
            audio.addEventListener('timeupdate', updateAudioProgress);
            
            // Play/Pause button functionality
            playPauseBtn.addEventListener('click', function() {
                if (audio.paused) {
                    audio.play();
                    playPauseBtn.textContent = '❚❚';
                } else {
                    audio.pause();
                    playPauseBtn.textContent = '▶';
                }
            });
            
            // Restart button functionality
            restartBtn.addEventListener('click', function() {
                audio.currentTime = 0;
                if (audio.paused) {
                    audio.play();
                    playPauseBtn.textContent = '❚❚';
                }
            });
            
            // Start reading button functionality
            startReadingBtn.addEventListener('click', function() {
                audio.play();
                playPauseBtn.textContent = '❚❚';
                window.scrollTo({
                    top: storyContainer.offsetTop - 100,
                    behavior: 'smooth'
                });
                startReadingBtn.style.display = 'none';
            });
            
            // Scroll to top button functionality
            scrollTopBtn.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // Show/hide scroll to top button based on scroll position
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    scrollTopBtn.style.opacity = '1';
                } else {
                    scrollTopBtn.style.opacity = '0';
                }
            });
            
            // Mobile menu functionality
            const navToggle = document.querySelector('.nav-toggle');
            const mobileMenu = document.querySelector('.mobile-menu');
            const closeBtn = document.querySelector('.close-btn');
            
            if (navToggle && mobileMenu && closeBtn) {
                navToggle.addEventListener('click', function() {
                    mobileMenu.classList.add('flex');
                    mobileMenu.classList.remove('hidden');
                });
                
                closeBtn.addEventListener('click', function() {
                    mobileMenu.classList.remove('flex');
                    mobileMenu.classList.add('hidden');
                });
                
                // Close mobile menu when clicking a link
                const mobileLinks = mobileMenu.querySelectorAll('a');
                mobileLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        mobileMenu.classList.remove('flex');
                        mobileMenu.classList.add('hidden');
                    });
                });
            }
            
            // Generate story panels on page load
            generateStoryPanels();
        });
    </script>
</body>
</html>